<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë§ˆë²• ìš”ë¦¬ì‚¬ - ì‚¬ìš´ë“œ & ì €ì¥ ì—ë””ì…˜</title>
    <style>
        body { margin: 0; background: #1c1c1c; color: #fff; font-family: 'Malgun Gothic', sans-serif; overflow: hidden; }
        #field { position: absolute; width: 100%; height: 100%; background: radial-gradient(circle, #2c2c2c, #111); }

        /* í•„ë“œ ë“œë ì•„ì´í…œ */
        .item {
            position: absolute; width: 48px; height: 48px;
            display: flex; align-items: center; justify-content: center;
            font-size: 32px; cursor: pointer; transition: transform 0.2s;
            filter: drop-shadow(0 0 5px rgba(255,255,255,0.3));
        }
        .item:hover { transform: scale(1.2); }

        /* ìºë¦­í„°(ì…°í”„) */
        #chef {
            position: absolute; bottom: 120px; left: 50%; transform: translateX(-50%);
            width: 80px; height: 140px; cursor: pointer; transition: 0.3s;
        }
        #chef:hover { filter: brightness(1.2); }
        #chef .head { width: 50px; height: 50px; border-radius: 50%; background: #ffd7a0; margin: auto; border: 2px solid #333; }
        #chef .body { width: 70px; height: 80px; background: #7a4; margin: auto; border-radius: 10px; border: 2px solid #333; position: relative; }
        #chef .body::after { content: "ğŸ‘¨â€ğŸ³"; position: absolute; top: 10px; left: 20px; font-size: 30px; }

        /* UI ê³µí†µ */
        #inventory, #avatarUI, #cookUI {
            background: rgba(17, 17, 17, 0.9); border: 2px solid #555;
            padding: 15px; border-radius: 10px; box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }

        /* ì¸ë²¤í† ë¦¬ */
        #inventory { position: absolute; top: 10px; left: 10px; width: 220px; max-height: 80vh; overflow-y: auto; }
        .invItem {
            display: inline-flex; flex-direction: column;
            align-items: center; width: 60px; margin: 5px; cursor: pointer;
            border: 1px solid #333; padding: 5px; border-radius: 5px; background: #222;
        }
        .invItem:hover { background: #333; border-color: #777; }

        /* ìš”ë¦¬ UI */
        #cookUI {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 420px; display: none; z-index: 100;
        }
        #cookHeader { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #444; padding-bottom: 10px; }
        #closeCook { cursor: pointer; color: #ff4444; font-weight: bold; font-size: 20px; }

        #slots { display: flex; gap: 10px; margin: 15px 0; justify-content: center; }
        .slot {
            width: 70px; height: 70px; border: 2px dashed #aaa; border-radius: 10px;
            display: flex; align-items: center; justify-content: center; font-size: 40px; cursor: pointer;
        }

        /* ê²Œì´ì§€ ë°” */
        .bar { height: 24px; background: #333; position: relative; margin: 8px 0; border-radius: 12px; overflow: hidden; border: 1px solid #000; }
        .fill { height: 100%; width: 50%; background: linear-gradient(to right, #ff9800, #f44336); transition: 0.1s; }
        .zone { position: absolute; top: 0; height: 100%; background: rgba(255, 255, 0, 0.3); border-left: 2px solid yellow; border-right: 2px solid yellow; }
        .successZone { background: rgba(0, 255, 0, 0.2); border-left: 2px solid #0f0; border-right: 2px solid #0f0; }

        /* ì•„ë°”íƒ€ UI */
        #avatarUI { position: absolute; top: 10px; right: 10px; width: 220px; display: flex; flex-direction: column; align-items: center; }
        
        button {
            padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer;
            font-weight: bold; transition: 0.2s;
        }
        #fire { background: #e64a19; color: white; }
        #water { background: #1976d2; color: white; }
        #start { background: #43a047; color: white; width: 100%; margin-top: 10px; font-size: 16px; }
        #resetData { background: #555; color: #ccc; font-size: 11px; margin-top: 15px; }
        button:hover { opacity: 0.8; transform: translateY(-2px); }
        #timeText { margin: 10px 0; font-size: 18px; text-align: center; color: #ffeb3b; }
    </style>
</head>

<body>
    <div id="field"></div>

    <div id="chef">
        <div class="head"></div>
        <div class="body"></div>
    </div>

    <div id="inventory"><b>ğŸ’ ì¸ë²¤í† ë¦¬</b><br></div>

    <div id="cookUI">
        <div id="cookHeader">
            <b>ğŸ”® ë§ˆë²• ì†¥ë‹¨ì§€</b>
            <span id="closeCook">âœ–</span>
        </div>
        <div id="timeText">ë‚¨ì€ ì‹œê°„: 120ì´ˆ</div>
        <div style="text-align:center">ì¬ë£Œ íˆ¬ì…: <span id="cnt">0</span> / 3</div>
        <div id="slots"></div>

        <div>ì ì • ì˜¨ë„ (ë…¸ë€ìƒ‰ ìœ ì§€)</div>
        <div class="bar">
            <div class="zone" style="left:35%;width:30%"></div>
            <div class="fill" id="heatFill"></div>
        </div>

        <div>ì™„ì„±ë„ (ì´ˆë¡ìƒ‰ ë²”ìœ„ì—ì„œ ìë™ ì„±ê³µ)</div>
        <div class="bar">
            <div class="zone successZone" style="left:60%;width:15%"></div>
            <div class="fill" id="progFill" style="background: #4caf50; width: 0%;"></div>
        </div>

        <div style="display:flex; gap:10px;">
            <button id="fire" style="flex:1">ğŸ”¥ í™”ë ¥ ì¡°ì ˆ (+)</button>
            <button id="water" style="flex:1">ğŸ’§ ëƒ‰ê° ì¡°ì ˆ (-)</button>
        </div>
        <button id="start">âœ¨ ë§ˆë²• ìš”ë¦¬ ì‹œì‘</button>
    </div>

    <div id="avatarUI">
        <b>ğŸ‘• ì¥ì°©ì‹¤</b>
        <div id="avatarSlots"></div>
        <button id="resetData">ì´ˆê¸°í™” (ëª¨ë“  ë°ì´í„° ì‚­ì œ)</button>
    </div>

    <script>
        // --- ì•„ì´í…œ ë°ì´í„° ---
        const items = [
            { name: "ì•Œ", icon: "ğŸ¥š" },
            { name: "ê°œêµ¬ë¦¬", icon: "ğŸ¸" },
            { name: "ì•½ì´ˆ", icon: "ğŸŒ¿" }
        ];

        const successItems = [
            { name: "ë¼ì§€ì½”", icon: "ğŸ½" }, { name: "ì‚°íƒ€ë¼ì§€ì½”", icon: "ğŸ…ğŸ½" }, { name: "í™©ê¸ˆë¼ì§€ì½”", icon: "ğŸ·âœ¨" },
            { name: "ì •ì¥", icon: "ğŸ‘”" }, { name: "ë„¥íƒ€ì´", icon: "ğŸ‘”" }, { name: "ë“œë ˆìŠ¤", icon: "ğŸ‘—" },
            { name: "í•´ì í‹°", icon: "â˜ ï¸ğŸ‘•" }, { name: "ë¬´ì°¬ì´ ë°˜ì§€", icon: "ğŸ’" }, { name: "ê°•ë‹¬ì´ ë°˜ì§€", icon: "ğŸ’" },
            { name: "ëŒ€ë°•ì´ ë°˜ì§€", icon: "ğŸ’" }, { name: "ì•„ë ¨ì´ ë°˜ì§€", icon: "ğŸ’" }, { name: "ë¯¸ë‹¨ì´ ë°˜ì§€", icon: "ğŸ’" },
            { name: "ì•„ì´í°25", icon: "ğŸ“±" }, { name: "ê°¤ëŸ­ì‹œí°", icon: "ğŸ“±" }, { name: "í˜•ê´‘ì˜·", icon: "ğŸ‘•âœ¨" }
        ];

        // --- ì‚¬ìš´ë“œ ì„¤ì • ---
        const fireSnd = new Audio("https://assets.mixkit.co/active_storage/sfx/2321/2321-preview.mp3");
        const waterSnd = new Audio("https://assets.mixkit.co/active_storage/sfx/1105/1105-preview.mp3");
        const successSnd = new Audio("https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3");
        const failSnd = new Audio("https://assets.mixkit.co/active_storage/sfx/255/255-preview.mp3");

        // --- ìƒíƒœ ë³€ìˆ˜ ---
        let inventory = [];
        let cookItems = [];
        let equipped = [];
        let cooking = false;
        let heat = 50, progress = 0;
        let timer = null, timeLeft = 120;

        const field = document.getElementById("field");
        const inv = document.getElementById("inventory");
        const cookUI = document.getElementById("cookUI");
        const slotsDiv = document.getElementById("slots");
        const cnt = document.getElementById("cnt");
        const heatFill = document.getElementById("heatFill");
        const progFill = document.getElementById("progFill");
        const chef = document.getElementById("chef");
        const timeText = document.getElementById("timeText");
        const avatarSlots = document.getElementById("avatarSlots");

        // --- ì €ì¥ ë° ë¶ˆëŸ¬ì˜¤ê¸° ---
        function saveData() {
            localStorage.setItem('magic_chef_inv', JSON.stringify(inventory));
            localStorage.setItem('magic_chef_eq', JSON.stringify(equipped));
        }

        function loadData() {
            const si = localStorage.getItem('magic_chef_inv');
            const se = localStorage.getItem('magic_chef_eq');
            if (si) inventory = JSON.parse(si);
            if (se) equipped = JSON.parse(se);
            updateInv();
            updateAvatar();
        }

        // --- ê¸°ëŠ¥ í•¨ìˆ˜ë“¤ ---
        function spawnItem() {
            if (cooking || document.querySelectorAll('.item').length > 10) return;
            const it = items[Math.floor(Math.random() * items.length)];
            const d = document.createElement("div");
            d.className = "item";
            d.innerText = it.icon;
            d.style.left = Math.random() * 90 + "%";
            d.style.top = Math.random() * 70 + "%";
            d.onclick = () => {
                inventory.push(it);
                d.remove();
                updateInv();
                saveData();
            };
            field.appendChild(d);
        }
        setInterval(spawnItem, 2500);

        function updateInv() {
            inv.innerHTML = "<b>ğŸ’ ì¸ë²¤í† ë¦¬</b><br>";
            inventory.forEach((it, i) => {
                const d = document.createElement("div");
                d.className = "invItem";
                d.innerHTML = `${it.icon}<br><small>${it.name}</small>`;
                d.onclick = () => addSlot(i);
                inv.appendChild(d);
            });
        }

        function updateSlots() {
            slotsDiv.innerHTML = "";
            for (let i = 0; i < 3; i++) {
                const s = document.createElement("div");
                s.className = "slot";
                if (cookItems[i]) s.innerText = cookItems[i].icon;
                s.onclick = () => {
                    if (cooking || !cookItems[i]) return;
                    inventory.push(cookItems[i]);
                    cookItems.splice(i, 1);
                    updateInv(); updateSlots(); saveData();
                };
                slotsDiv.appendChild(s);
            }
            cnt.innerText = cookItems.length;
        }

        function addSlot(i) {
            if (cooking || cookItems.length >= 3) return;
            cookItems.push(inventory[i]);
            inventory.splice(i, 1);
            updateInv(); updateSlots(); saveData();
        }

        function updateAvatar() {
            avatarSlots.innerHTML = "";
            equipped.forEach(it => {
                const d = document.createElement("div");
                d.className = "invItem";
                d.innerHTML = `${it.icon}<br><small>${it.name}</small>`;
                d.onclick = () => {
                    alert(`${it.name}ì„(ë¥¼) ì°©ìš©í–ˆìŠµë‹ˆë‹¤!`);
                    chef.style.filter = "drop-shadow(0 0 10px gold) brightness(1.2)";
                };
                avatarSlots.appendChild(d);
            });
        }

        chef.onclick = () => { if (!cooking) cookUI.style.display = "block"; };
        document.getElementById("closeCook").onclick = () => {
            if (cooking) return;
            cookUI.style.display = "none";
            cookItems.forEach(it => inventory.push(it));
            cookItems = [];
            updateInv(); updateSlots();
        };

        // --- ë¶ˆ/ë¬¼ ì‚¬ìš´ë“œ ì—°ë™ ---
        document.getElementById("fire").onclick = () => {
            if (!cooking) return;
            fireSnd.currentTime = 0; fireSnd.play();
            heat = Math.min(100, heat + 7);
            updateBars();
        };

        document.getElementById("water").onclick = () => {
            if (!cooking) return;
            waterSnd.currentTime = 0; waterSnd.play();
            heat = Math.max(0, heat - 7);
            updateBars();
        };

        document.getElementById("start").onclick = () => {
            if (cookItems.length < 3 || cooking) return;
            cooking = true;
            timeLeft = 120; progress = 0; heat = 50;
            updateBars();

            timer = setInterval(() => {
                timeLeft--;
                timeText.innerText = `ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`;

                // ì˜¨ë„ ìœ ì§€ íŒì • (35%~65% ì‚¬ì´ì¼ ë•Œë§Œ ì§„í–‰ë„ ìƒìŠ¹)
                if (heat >= 35 && heat <= 65) {
                    progress += 1.5;
                } else {
                    progress = Math.max(0, progress - 0.5); // ì˜¨ë„ ì•ˆë§ìœ¼ë©´ ì§„í–‰ë„ ê°ì†Œ
                }

                // ì„±ê³µ ë²”ìœ„ ë„ë‹¬ íŒì • (60% ~ 75%)
                if (progress >= 60 && progress <= 75) {
                    finish(true);
                }

                if (timeLeft <= 0 || progress >= 100) {
                    finish(false);
                }
                updateBars();
            }, 1000);
        };

        function updateBars() {
            heatFill.style.width = heat + "%";
            progFill.style.width = Math.min(progress, 100) + "%";
        }

        function finish(success) {
            clearInterval(timer);
            timer = null;
            cooking = false;
            cookUI.style.display = "none";

            if (success) {
                successSnd.play();
                const newItem = successItems[Math.floor(Math.random() * successItems.length)];
                inventory.push(newItem);
                equipped.push(newItem);
                updateInv(); updateAvatar(); saveData();
                alert(`ğŸŠ ëŒ€ì„±ê³µ! ë§ˆë²•ì˜ ì‚°ë¬¼ [${newItem.name}]ì„(ë¥¼) íšë“í–ˆìŠµë‹ˆë‹¤!`);
            } else {
                failSnd.play();
                alert("ğŸ’¨ ì—°ê¸°ì™€ í•¨ê»˜ ìš”ë¦¬ê°€ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤... (ì‹¤íŒ¨)");
            }
            cookItems = [];
            updateSlots();
            saveData();
        }

        document.getElementById('resetData').onclick = () => {
            if (confirm("ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³  ì²˜ìŒë¶€í„° ì‹œì‘í• ê¹Œìš”?")) {
                localStorage.clear();
                location.reload();
            }
        };

        // ì´ˆê¸° ì‹¤í–‰
        loadData();
    </script>
</body>
</html>