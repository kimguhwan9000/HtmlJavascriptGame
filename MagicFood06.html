<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë§ˆë²• ìš”ë¦¬ì‚¬ - ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€</title>
<style>
/* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ê·¸ëŒ€ë¡œ ìœ ì§€ */
body{margin:0;background:#1c1c1c;color:#fff;font-family:sans-serif;overflow:hidden}
#field{position:absolute;width:100%;height:100%}
.item{position:absolute;width:48px;height:48px;display:flex;align-items:center;justify-content:center;font-size:32px;cursor:pointer}
#chef{position:absolute;bottom:120px;left:50%;transform:translateX(-50%);width:80px;height:140px;cursor:pointer}
#chef .head{width:50px;height:50px;border-radius:50%;background:#ffd7a0;margin:auto}
#chef .body{width:70px;height:80px;background:#7a4;margin:auto;border-radius:10px}
#inventory{position:absolute;top:10px;left:10px;background:#111;border:2px solid #555;padding:10px;width:220px;max-height:80vh;overflow-y:auto}
.invItem{display:inline-flex;flex-direction:column;align-items:center;width:50px;margin:5px;cursor:pointer}
#cookUI{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#111;border:3px solid #999;padding:12px;width:420px;display:none}
#cookHeader{display:flex;justify-content:space-between;align-items:center}
#closeCook{cursor:pointer;color:red}
#slots{display:flex;gap:10px;margin:10px 0}
.slot{width:60px;height:60px;border:2px dashed #aaa;display:flex;align-items:center;justify-content:center;font-size:32px;cursor:pointer}
.bar{height:20px;background:#333;position:relative;margin:5px 0}
.fill{height:100%;width:50%;background:#ff9800}
.zone{position:absolute;top:0;height:100%;background:rgba(255,255,0,0.4)}
.successZone{background:rgba(255,0,0,0.55)}
#avatarUI{position:absolute;top:10px;right:10px;background:#111;border:2px solid #555;padding:10px;width:200px;max-height:80vh;overflow-y:auto;display:flex;flex-direction:column;align-items:center}
button{margin:3px;padding:5px 10px}
#timeText{margin:5px 0;font-weight:bold}
/* ë°ì´í„° ì´ˆê¸°í™” ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
#resetData { margin-top: 10px; background: #666; color: #fff; border: none; cursor: pointer; font-size: 11px;}
</style>
</head>

<body>
<div id="field"></div>

<div id="chef">
 <div class="head"></div>
 <div class="body"></div>
</div>

<div id="inventory"><b>ì¸ë²¤í† ë¦¬</b><br></div>

<div id="cookUI">
 <div id="cookHeader">
  <b>ë§ˆë²• ìš”ë¦¬</b>
  <span id="closeCook">âœ–</span>
 </div>
 <div id="timeText">ë‚¨ì€ ì‹œê°„: 120ì´ˆ</div>
 <div>ì¬ë£Œ <span id="cnt">0</span>/3</div>
 <div id="slots"></div>
 <div>ì˜¨ë„</div>
 <div class="bar">
  <div class="zone" style="left:35%;width:30%"></div>
  <div class="fill" id="heatFill"></div>
 </div>
 <div>ì§„í–‰ë„</div>
 <div class="bar">
  <div class="zone successZone" style="left:60%;width:10%"></div>
  <div class="fill" id="progFill" style="background:#ff4444"></div>
 </div>
 <button id="fire">ğŸ”¥ ë¶ˆ</button>
 <button id="water">ğŸ’§ ë¬¼</button>
 <button id="start">ìš”ë¦¬ ì‹œì‘</button>
</div>

<div id="avatarUI">
    <b>ì•„ë°”íƒ€</b>
    <div id="avatarSlots"></div>
    <button id="resetData">ë°ì´í„° ì´ˆê¸°í™”</button>
</div>

<script>
// --- ë°ì´í„° ë¦¬ìŠ¤íŠ¸ëŠ” ê¸°ì¡´ê³¼ ë™ì¼ ---
const items=[
 {name:"ì•Œ",icon:"ğŸ¥š"},
 {name:"ê°œêµ¬ë¦¬",icon:"ğŸ¸"},
 {name:"ì•½ì´ˆ",icon:"ğŸŒ¿"}
];

const successItems=[
 {name:"ë¼ì§€ì½”",icon:"ğŸ½"}, {name:"ì‚°íƒ€ë¼ì§€ì½”",icon:"ğŸ…ğŸ½"}, {name:"í™©ê¸ˆë¼ì§€ì½”",icon:"ğŸ·âœ¨"},
 {name:"ì •ì¥",icon:"ğŸ‘”"}, {name:"ë„¥íƒ€ì´",icon:"ğŸ‘”"}, {name:"ë“œë ˆìŠ¤",icon:"ğŸ‘—"},
 {name:"í•´ì í‹°",icon:"â˜ ï¸ğŸ‘•"}, {name:"ë¬´ì°¬ì´ ë³€ì‹ ë°˜ì§€",icon:"ğŸ’"}, {name:"ê°•ë‹¬ì´ ë³€ì‹ ë°˜ì§€",icon:"ğŸ’"},
 {name:"ëŒ€ë°•ì´ ë³€ì‹ ë°˜ì§€",icon:"ğŸ’"}, {name:"ì•„ë ¨ì´ ë³€ì‹ ë°˜ì§€",icon:"ğŸ’"}, {name:"ë¯¸ë‹¨ì´ ë³€ì‹ ë°˜ì§€",icon:"ğŸ’"},
 {name:"ì¥ë†",icon:"ğŸ›ï¸"}, {name:"ë³€ì‹ ë°˜ì§€",icon:"ğŸ’"}, {name:"í•´ì í‹°",icon:"â˜ ï¸ğŸ‘•"},
 {name:"ì˜·",icon:"ğŸ‘•"}, {name:"í˜•ê´‘ì˜·",icon:"ğŸ‘•âœ¨"}, {name:"TV",icon:"ğŸ“º"},
 {name:"ì•„ì´í°",icon:"ğŸ“±"}, {name:"ì•ˆë“œë¡œì´ë“œí°",icon:"ğŸ¤–ğŸ“±"}, {name:"ì•„ì´í°25",icon:"ğŸ“±"},
 {name:"ì•„ì´í°7",icon:"ğŸ“±"}, {name:"ì•„ì´í°1",icon:"ğŸ“±"}, {name:"ê°¤ëŸ­ì‹œí°",icon:"ğŸ“±"}
];

const field=document.getElementById("field");
const inv=document.getElementById("inventory");
const cookUI=document.getElementById("cookUI");
const slotsDiv=document.getElementById("slots");
const cnt=document.getElementById("cnt");
const heatFill=document.getElementById("heatFill");
const progFill=document.getElementById("progFill");
const chef=document.getElementById("chef");
const closeCook=document.getElementById("closeCook");
const timeText=document.getElementById("timeText");
const avatarSlots=document.getElementById("avatarSlots");

const fireSnd=new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_3b8b6c02c0.mp3");
const waterSnd=new Audio("https://cdn.pixabay.com/audio/2022/03/10/audio_9bfe91f9c6.mp3");

let inventory=[];
let cookItems=[];
let cooking=false;
let heat=50,progress=0;
let timer=null, timeLeft=120;
let equipped=[];

// --- [ì¶”ê°€] ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥ ë° ë¶ˆëŸ¬ì˜¤ê¸° ---

// 1. ì €ì¥ í•¨ìˆ˜
function saveData() {
    localStorage.setItem('chef_inventory', JSON.stringify(inventory));
    localStorage.setItem('chef_equipped', JSON.stringify(equipped));
}

// 2. ë¶ˆëŸ¬ì˜¤ê¸° í•¨ìˆ˜
function loadData() {
    const savedInv = localStorage.getItem('chef_inventory');
    const savedEquipped = localStorage.getItem('chef_equipped');
    
    if (savedInv) inventory = JSON.parse(savedInv);
    if (savedEquipped) equipped = JSON.parse(savedEquipped);
    
    updateInv();
    updateAvatar();
}

// ì´ˆê¸° ë¡œë“œ ì‹¤í–‰
loadData();

/* ì•„ì´í…œ ìŠ¤í° */
function spawnItem(){
 if(cooking) return;
 const it=items[Math.floor(Math.random()*items.length)];
 const d=document.createElement("div");
 d.className="item";
 d.innerText=it.icon;
 d.style.left=Math.random()*90+"%";
 d.style.top=Math.random()*80+"%";
 d.onclick=()=>{
  inventory.push(it);
  d.remove();
  updateInv();
  saveData(); // ì•„ì´í…œ íšë“ ì‹œ ì €ì¥
 };
 field.appendChild(d);
}
setInterval(spawnItem,2000);

/* ì¸ë²¤ */
function updateInv(){
 inv.innerHTML="<b>ì¸ë²¤í† ë¦¬</b><br>";
 inventory.forEach((it,i)=>{
  const d=document.createElement("div");
  d.className="invItem";
  d.innerHTML=`${it.icon}<br>${it.name}`;
  d.onclick=()=>addSlot(i);
  inv.appendChild(d);
 });
}

/* ìŠ¬ë¡¯ */
function updateSlots(){
 slotsDiv.innerHTML="";
 for(let i=0;i<3;i++){
  const s=document.createElement("div");
  s.className="slot";
  if(cookItems[i]) s.innerText=cookItems[i].icon;
  s.onclick=()=>{
   if(cooking||!cookItems[i]) return;
   inventory.push(cookItems[i]);
   cookItems.splice(i,1);
   updateInv();
   updateSlots();
   saveData(); // ìŠ¬ë¡¯ì—ì„œ ëº„ ë•Œ ì €ì¥
  };
  slotsDiv.appendChild(s);
 }
 cnt.innerText=cookItems.length;
}

/* ìŠ¬ë¡¯ ì¶”ê°€ */
function addSlot(i){
 if(cooking||cookItems.length>=3) return;
 cookItems.push(inventory[i]);
 inventory.splice(i,1);
 updateInv();
 updateSlots();
 saveData(); // ìŠ¬ë¡¯ì— ë„£ì„ ë•Œ ì €ì¥
}

/* ì•„ë°”íƒ€ UI */
function updateAvatar(){
 avatarSlots.innerHTML="";
 equipped.forEach(it=>{
  const d=document.createElement("div");
  d.className="invItem";
  d.innerHTML=`${it.icon}<br>${it.name}`;
  d.onclick=()=>{
   alert(`${it.name} ì°©ìš©!`);
   chef.style.filter="brightness(1.4)";
  };
  avatarSlots.appendChild(d);
 });
}

/* ìš”ë¦¬ UI */
chef.onclick=()=>{
 if(cooking) return;
 cookUI.style.display="block";
};

closeCook.onclick=()=>{
 if(cooking) return;
 cookUI.style.display="none";
 cookItems=[];
 updateSlots();
};

/* ë²„íŠ¼ */
fire.onclick=()=>{
 if(!cooking) return;
 fireSnd.currentTime=0; fireSnd.play();
 heat=Math.min(100,heat+5);
 updateBars();
};

water.onclick=()=>{
 if(!cooking) return;
 waterSnd.currentTime=0; waterSnd.play();
 heat=Math.max(0,heat-5);
 updateBars();
};

start.onclick=()=>{
 if(cookItems.length<3||cooking) return;
 cooking=true;
 timeLeft=120;
 progress=0;
 heat=50;
 updateBars();

 timer=setInterval(()=>{
  timeLeft--;
  timeText.innerText="ë‚¨ì€ ì‹œê°„: "+timeLeft+"ì´ˆ";
  if(heat>=35&&heat<=65) progress+=1;
  if(progress>=60&&progress<=70 && timeLeft>0) finish(true);
  if(timeLeft<=0) finish(false);
  updateBars();
 },1000);
};

function updateBars(){
 heatFill.style.width=heat+"%";
 progFill.style.width=Math.min(progress,100)+"%";
}

/* ì¢…ë£Œ */
function finish(success){
 clearInterval(timer);
 timer=null;
 cooking=false;
 cookUI.style.display="none";
 if(success){
  const newItem=successItems[Math.floor(Math.random()*successItems.length)];
  inventory.push(newItem);
  equipped.push(newItem);
  updateInv();
  updateAvatar();
  saveData(); // ì„±ê³µ ì‹œ ì•„ì´í…œ ì¶”ê°€ ì €ì¥
  alert(`âœ¨ ìš”ë¦¬ ì„±ê³µ! ìƒˆë¡œìš´ ì•„ì´í…œ íšë“: ${newItem.name}`);
 } else {
  cookItems=[];
  updateSlots();
  saveData(); // ì‹¤íŒ¨ ì‹œ ì¬ë£Œ ì†Œëª¨ ì €ì¥
  alert("ğŸ’¥ ìš”ë¦¬ ì‹¤íŒ¨! ì¬ë£Œ ì†Œì‹¤");
 }
 cookItems=[];
 updateSlots();
}

// [ì¶”ê°€] ì´ˆê¸°í™” ê¸°ëŠ¥
document.getElementById('resetData').onclick = () => {
    if(confirm("ëª¨ë“  ì¸ë²¤í† ë¦¬ì™€ ì•„ë°”íƒ€ ì •ë³´ê°€ ì‚­ì œë©ë‹ˆë‹¤. ì´ˆê¸°í™”í• ê¹Œìš”?")) {
        localStorage.clear();
        inventory = [];
        equipped = [];
        updateInv();
        updateAvatar();
    }
}
</script>
</body>
</html>